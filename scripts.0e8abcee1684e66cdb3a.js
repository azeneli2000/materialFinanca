(function(){"use strict";function e(e){return"function"==typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},n=Date.now||function(){return(new Date).getTime()};function r(){}var o=Object.create||function(e){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof e)throw new TypeError("Argument must be an object");return r.prototype=e,new r};function i(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function s(e){var t=e._promiseCallbacks;return t||(t=e._promiseCallbacks={}),t}var c={mixin:function(e){return e.on=this.on,e.off=this.off,e.trigger=this.trigger,e._promiseCallbacks=void 0,e},on:function(e,t){if("function"!=typeof t)throw new TypeError("Callback must be a function");var n,r=s(this);(n=r[e])||(n=r[e]=[]),-1===i(n,t)&&n.push(t)},off:function(e,t){var n,r,o=s(this);t?-1!==(r=i(n=o[e],t))&&n.splice(r,1):o[e]=[]},trigger:function(e,t,n){var r;if(r=s(this)[e])for(var o=0;o<r.length;o++)(0,r[o])(t,n)}},a={instrument:!1};function u(e,t){if("onerror"!==e)return 2!==arguments.length?a[e]:void(a[e]=t);a.on("error",t)}c.mixin(a);var l=[],f=function(e,t,r){1===l.push({name:e,payload:{key:t._guidKey,id:t._id,eventName:e,detail:t._result,childId:r&&r._id,label:t._label,timeStamp:n(),error:a["instrument-with-stack"]?new Error(t._label):null}})&&setTimeout(function(){for(var e,t=0;t<l.length;t++){var n=(e=l[t]).payload;n.guid=n.key+n.id,n.childGuid=n.key+n.childId,n.error&&(n.stack=n.error.stack),a.trigger(e.name,e.payload)}l.length=0},50)};function p(){}var d=void 0,h=1,b=2,y=new S;function v(t,n){var r;t===n?m(t,n):"function"==typeof(r=n)||"object"==typeof r&&null!==r?function(t,n){if(n.constructor===t.constructor)!function(e,t){t._state===h?m(e,t._result):t._state===b?(t._onError=null,g(e,t._result)):k(t,void 0,function(n){t!==n?v(e,n):m(e,n)},function(t){g(e,t)})}(t,n);else{var r=function(e){try{return e.then}catch(t){return y.error=t,y}}(n);r===y?g(t,y.error):void 0===r?m(t,n):e(r)?function(e,t,n){a.async(function(e){var r=!1,o=function(n,o,i,s){try{n.call(o,function(n){r||(r=!0,t!==n?v(e,n):m(e,n))},function(t){r||(r=!0,g(e,t))})}catch(c){return c}}(n,t);!r&&o&&(r=!0,g(e,o))},e)}(t,n,r):m(t,n)}}(t,n):m(t,n)}function w(e){e._onError&&e._onError(e._result),_(e)}function m(e,t){e._state===d&&(e._result=t,e._state=h,0===e._subscribers.length?a.instrument&&f("fulfilled",e):a.async(_,e))}function g(e,t){e._state===d&&(e._state=b,e._result=t,a.async(w,e))}function k(e,t,n,r){var o=e._subscribers,i=o.length;e._onError=null,o[i]=t,o[i+h]=n,o[i+b]=r,0===i&&e._state&&a.async(_,e)}function _(e){var t=e._subscribers,n=e._state;if(a.instrument&&f(n===h?"fulfilled":"rejected",e),0!==t.length){for(var r,o,i=e._result,s=0;s<t.length;s+=3)o=t[s+n],(r=t[s])?I(n,r,o,i):o(i);e._subscribers.length=0}}function S(){this.error=null}var C=new S;function I(t,n,r,o){var i,s,c,a,u=e(r);if(u){if((i=function(e,t){try{return e(t)}catch(n){return C.error=n,C}}(r,o))===C?(a=!0,s=i.error,i=null):c=!0,n===i)return void g(n,new TypeError("A promises callback cannot return that same promise."))}else i=o,c=!0;n._state!==d||(u&&c?v(n,i):a?g(n,s):t===h?m(n,i):t===b&&g(n,i))}function A(e,t,n){return e===h?{state:"fulfilled",value:n}:{state:"rejected",reason:n}}function E(e,t,n,r){this._instanceConstructor=e,this.promise=new e(p,r),this._abortOnReject=n,this._validateInput(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._init(),0===this.length?m(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&m(this.promise,this._result))):g(this.promise,this._validationError())}var P=E;E.prototype._validateInput=function(e){return t(e)},E.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},E.prototype._init=function(){this._result=new Array(this.length)},E.prototype._enumerate=function(){for(var e=this.length,t=this.promise,n=this._input,r=0;t._state===d&&r<e;r++)this._eachEntry(n[r],r)},E.prototype._eachEntry=function(e,t){var n,r=this._instanceConstructor;"object"==typeof(n=e)&&null!==n?e.constructor===r&&e._state!==d?(e._onError=null,this._settledAt(e._state,t,e._result)):this._willSettleAt(r.resolve(e),t):(this._remaining--,this._result[t]=this._makeResult(h,t,e))},E.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===d&&(this._remaining--,this._abortOnReject&&e===b?g(r,n):this._result[t]=this._makeResult(e,t,n)),0===this._remaining&&m(r,this._result)},E.prototype._makeResult=function(e,t,n){return n},E.prototype._willSettleAt=function(e,t){var n=this;k(e,void 0,function(e){n._settledAt(h,t,e)},function(e){n._settledAt(b,t,e)})};var j=function(e,t){if(e&&"object"==typeof e&&e.constructor===this)return e;var n=new this(p,t);return v(n,e),n},O="rsvp_"+n()+"-",D=0;function T(t,n){this._id=D++,this._label=n,this._state=void 0,this._result=void 0,this._subscribers=[],a.instrument&&f("created",this),p!==t&&(e(t)||function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof T||function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}(),function(e,t){var n=!1;try{t(function(t){n||(n=!0,v(e,t))},function(t){n||(n=!0,g(e,t))})}catch(r){g(e,r)}}(this,t))}var x=T;function R(e,t,n){this._superConstructor(e,t,!1,n)}T.cast=j,T.all=function(e,t){return new P(this,e,!0,t).promise},T.race=function(e,n){var r=new this(p,n);if(!t(e))return g(r,new TypeError("You must pass an array to race.")),r;var o=e.length;function i(e){v(r,e)}function s(e){g(r,e)}for(var c=0;r._state===d&&c<o;c++)k(this.resolve(e[c]),void 0,i,s);return r},T.resolve=j,T.reject=function(e,t){var n=new this(p,t);return g(n,e),n},T.prototype={constructor:T,_guidKey:O,_onError:function(e){var t=this;a.after(function(){t._onError&&a.trigger("error",e,t._label)})},then:function(e,t,n){var r=this._state;if(r===h&&!e||r===b&&!t)return a.instrument&&f("chained",this,this),this;this._onError=null;var o=new this.constructor(p,n),i=this._result;if(a.instrument&&f("chained",this,o),r){var s=arguments[r-1];a.async(function(){I(r,o,s,i)})}else k(this,o,e,t);return o},catch:function(e,t){return this.then(void 0,e,t)},finally:function(e,t){var n=this.constructor;return this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})},t)}},(R.prototype=o(P.prototype))._superConstructor=P,R.prototype._makeResult=A,R.prototype._validationError=function(){return new Error("allSettled must be called with an array")};var N,U=0,M="undefined"!=typeof window?window:void 0,H=M||{},z=H.MutationObserver||H.WebKitMutationObserver,q="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),L="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function J(){return function(){setTimeout(F,1)}}var W,Q,Z,B,G,V,Y,K=new Array(1e3);function F(){for(var e=0;e<U;e+=2)(0,K[e])(K[e+1]),K[e]=void 0,K[e+1]=void 0;U=0}function X(e,t,n){this._superConstructor(e,t,!0,n)}q?(V=process.nextTick,Y=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/),Array.isArray(Y)&&"0"===Y[1]&&"10"===Y[2]&&(V=setImmediate),W=function(){V(F)}):z?(Z=0,B=new z(F),G=document.createTextNode(""),B.observe(G,{characterData:!0}),W=function(){G.data=Z=++Z%2}):L?((Q=new MessageChannel).port1.onmessage=F,W=function(){Q.port2.postMessage(0)}):W=void 0===M&&"function"==typeof require?function(){try{var e=require("vertx");return N=e.runOnLoop||e.runOnContext,function(){N(F)}}catch(t){return J()}}():J();var $=X;function ee(e,t,n){this._superConstructor(e,t,!1,n)}function te(){this.value=void 0}(X.prototype=o(P.prototype))._superConstructor=P,X.prototype._init=function(){this._result={}},X.prototype._validateInput=function(e){return e&&"object"==typeof e},X.prototype._validationError=function(){return new Error("Promise.hash must be called with an object")},X.prototype._enumerate=function(){var e=this.promise,t=this._input,n=[];for(var r in t)e._state===d&&Object.prototype.hasOwnProperty.call(t,r)&&n.push({position:r,entry:t[r]});var o,i=n.length;this._remaining=i;for(var s=0;e._state===d&&s<i;s++)this._eachEntry((o=n[s]).entry,o.position)},(ee.prototype=o($.prototype))._superConstructor=P,ee.prototype._makeResult=A,ee.prototype._validationError=function(){return new Error("hashSettled must be called with an object")};var ne,re=new te,oe=new te;function ie(e,t,n){try{e.apply(t,n)}catch(r){return re.value=r,re}}function se(e,t){return{then:function(n,r){return e.call(t,n,r)}}}function ce(e){return!(!e||"object"!=typeof e)&&(e.constructor===x||function(e){try{return e.then}catch(t){return re.value=t,re}}(e))}if("object"==typeof self)ne=self;else{if("object"!=typeof global)throw new Error("no global: `self` or `global` found");ne=global}var ae=ne;function ue(){a.on.apply(a,arguments)}if(a.async=function(e,t){K[U]=e,K[U+1]=t,2===(U+=2)&&W()},a.after=function(e){setTimeout(e,0)},"undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var le=window.__PROMISE_INSTRUMENTATION__;for(var fe in u("instrument",!0),le)le.hasOwnProperty(fe)&&ue(fe,le[fe])}var pe={race:function(e,t){return x.race(e,t)},Promise:x,allSettled:function(e,t){return new R(x,e,t).promise},hash:function(e,t){return new $(x,e,t).promise},hashSettled:function(e,t){return new ee(x,e,t).promise},denodeify:function(e,n){var r=function(){for(var r,o=arguments.length,i=new Array(o+1),s=!1,c=0;c<o;++c){if(r=arguments[c],!s){if((s=ce(r))===oe){var a=new x(p);return g(a,oe.value),a}s&&!0!==s&&(r=se(s,r))}i[c]=r}var u=new x(p);return i[o]=function(e,r){e?g(u,e):void 0===n?v(u,r):!0===n?v(u,function(e){for(var t=e.length,n=new Array(t-1),r=1;r<t;r++)n[r-1]=e[r];return n}(arguments)):t(n)?v(u,function(e,t){for(var n,r={},o=e.length,i=new Array(o),s=0;s<o;s++)i[s]=e[s];for(n=0;n<t.length;n++)r[t[n]]=i[n+1];return r}(arguments,n)):v(u,r)},s?function(e,t,n,r){return x.all(t).then(function(t){var o=ie(n,r,t);return o===re&&g(e,o.value),e})}(u,i,e,this):function(e,t,n,r){var o=ie(n,r,t);return o===re&&g(e,o.value),e}(u,i,e,this)};return r.__proto__=e,r},on:ue,off:function(){a.off.apply(a,arguments)},map:function(t,n,r){return x.all(t,r).then(function(t){if(!e(n))throw new TypeError("You must pass a function as map's second argument.");for(var o=t.length,i=new Array(o),s=0;s<o;s++)i[s]=n(t[s]);return x.all(i,r)})},filter:function(t,n,r){return x.all(t,r).then(function(t){if(!e(n))throw new TypeError("You must pass a function as filter's second argument.");for(var o=t.length,i=new Array(o),s=0;s<o;s++)i[s]=n(t[s]);return x.all(i,r).then(function(e){for(var n=new Array(o),r=0,i=0;i<o;i++)e[i]&&(n[r]=t[i],r++);return n.length=r,n})})},resolve:function(e,t){return x.resolve(e,t)},reject:function(e,t){return x.reject(e,t)},all:function(e,t){return x.all(e,t)},rethrow:function(e){throw setTimeout(function(){throw e}),e},defer:function(e){var t={};return t.promise=new x(function(e,n){t.resolve=e,t.reject=n},e),t},EventTarget:c,configure:u,async:function(e,t){a.async(e,t)}};"function"==typeof define&&define.amd?define(function(){return pe}):"undefined"!=typeof module&&module.exports?module.exports=pe:void 0!==ae&&(ae.RSVP=pe)}).call(this);var Sha256={hash:function(e){e=e.utf8Encode();var t=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],n=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];e+=String.fromCharCode(128);for(var r=Math.ceil((e.length/4+2)/16),o=new Array(r),i=0;r>i;i++){o[i]=new Array(16);for(var s=0;16>s;s++)o[i][s]=e.charCodeAt(64*i+4*s)<<24|e.charCodeAt(64*i+4*s+1)<<16|e.charCodeAt(64*i+4*s+2)<<8|e.charCodeAt(64*i+4*s+3)}o[r-1][14]=8*(e.length-1)/Math.pow(2,32),o[r-1][14]=Math.floor(o[r-1][14]),o[r-1][15]=8*(e.length-1)&4294967295;var c,a,u,l,f,p,d,h,b=new Array(64);for(i=0;r>i;i++){for(var y=0;16>y;y++)b[y]=o[i][y];for(y=16;64>y;y++)b[y]=Sha256.\u03c31(b[y-2])+b[y-7]+Sha256.\u03c30(b[y-15])+b[y-16]&4294967295;for(c=n[0],a=n[1],u=n[2],l=n[3],f=n[4],p=n[5],d=n[6],h=n[7],y=0;64>y;y++){var v=h+Sha256.\u03a31(f)+Sha256.Ch(f,p,d)+t[y]+b[y],w=Sha256.\u03a30(c)+Sha256.Maj(c,a,u);h=d,d=p,p=f,f=l+v&4294967295,l=u,u=a,a=c,c=v+w&4294967295}n[0]=n[0]+c&4294967295,n[1]=n[1]+a&4294967295,n[2]=n[2]+u&4294967295,n[3]=n[3]+l&4294967295,n[4]=n[4]+f&4294967295,n[5]=n[5]+p&4294967295,n[6]=n[6]+d&4294967295,n[7]=n[7]+h&4294967295}return Sha256.toHexStr(n[0])+Sha256.toHexStr(n[1])+Sha256.toHexStr(n[2])+Sha256.toHexStr(n[3])+Sha256.toHexStr(n[4])+Sha256.toHexStr(n[5])+Sha256.toHexStr(n[6])+Sha256.toHexStr(n[7])},ROTR:function(e,t){return t>>>e|t<<32-e},"\u03a30":function(e){return Sha256.ROTR(2,e)^Sha256.ROTR(13,e)^Sha256.ROTR(22,e)},"\u03a31":function(e){return Sha256.ROTR(6,e)^Sha256.ROTR(11,e)^Sha256.ROTR(25,e)},"\u03c30":function(e){return Sha256.ROTR(7,e)^Sha256.ROTR(18,e)^e>>>3},"\u03c31":function(e){return Sha256.ROTR(17,e)^Sha256.ROTR(19,e)^e>>>10},Ch:function(e,t,n){return e&t^~e&n},Maj:function(e,t,n){return e&t^e&n^t&n},toHexStr:function(e){for(var t="",n=7;n>=0;n--)t+=(e>>>4*n&15).toString(16);return t}};void 0===String.prototype.utf8Encode&&(String.prototype.utf8Encode=function(){return unescape(encodeURIComponent(this))}),void 0===String.prototype.utf8Decode&&(String.prototype.utf8Decode=function(){try{return decodeURIComponent(escape(this))}catch(e){return this}}),"undefined"!=typeof module&&module.exports&&(module.exports=Sha256),"function"==typeof define&&define.amd&&define([],function(){return Sha256});var qz=function(){Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var e={VERSION:"2.0.8",DEBUG:!1,log:{trace:function(){e.DEBUG&&console.log.apply(console,arguments)},info:function(){console.info.apply(console,arguments)},warn:function(){e.DEBUG&&console.warn.apply(console,arguments)},error:function(){console.error.apply(console,arguments)}},streams:{serial:"SERIAL",usb:"USB",hid:"HID"},websocket:{connection:null,connectConfig:{host:["localhost","localhost.qz.io"],hostIndex:0,usingSecure:!0,protocol:{secure:"wss://",insecure:"ws://"},port:{secure:[8181,8282,8383,8484],insecure:[8182,8283,8384,8485],portIndex:0},keepAlive:60,retries:0,delay:0},setup:{findConnection:function(t,n,r){if(t.port.secure.length)t.port.insecure.length||t.usingSecure||(e.log.trace("No insecure ports specified - forcing secure connection"),t.usingSecure=!0);else{if(!t.port.insecure.length)return void r(new Error("No ports have been specified to connect over"));t.usingSecure&&(e.log.error("No secure ports specified - forcing insecure connection"),t.usingSecure=!1)}var o,i=function(){if(t.port.portIndex++,t.usingSecure&&t.port.portIndex>=t.port.secure.length||!t.usingSecure&&t.port.portIndex>=t.port.insecure.length){if(t.hostIndex>=t.host.length-1)return void r(new Error("Unable to establish connection with QZ"));t.hostIndex++,t.port.portIndex=0}e.websocket.setup.findConnection(t,n,r)};o=t.usingSecure?t.protocol.secure+t.host[t.hostIndex]+":"+t.port.secure[t.port.portIndex]:t.protocol.insecure+t.host[t.hostIndex]+":"+t.port.insecure[t.port.portIndex];try{e.log.trace("Attempting connection",o),e.websocket.connection=new e.tools.ws(o)}catch(s){return e.log.error(s),void i()}null!=e.websocket.connection?(e.websocket.connection.established=!1,e.websocket.connection.onopen=function(i){if(!e.websocket.connection.established&&(e.log.trace(i),e.log.info("Established connection with QZ Tray on "+o),e.websocket.setup.openConnection({resolve:n,reject:r}),t.keepAlive>0))var s=setInterval(function(){qz.websocket.isActive()?e.websocket.connection.send("ping"):clearInterval(s)},1e3*t.keepAlive)},e.websocket.connection.onclose=function(){e.websocket.connection&&"undefined"!=typeof navigator&&-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")&&e.websocket.connection.onerror()},e.websocket.connection.onerror=function(t){e.log.trace(t),e.websocket.connection=null,i()}):r(new Error("Unable to create a websocket connection"))},openConnection:function(t){function n(n){void 0===n&&(n=null),e.websocket.connection.sendData({certificate:n,promise:t})}e.websocket.connection.established=!0,e.websocket.connection.onclose=function(t){for(var n in e.log.trace(t),e.log.info("Closed connection with QZ Tray"),null!=e.websocket.connection.promise&&e.websocket.connection.promise.resolve(),e.websocket.callClose(t),e.websocket.connection=null,e.websocket.pendingCalls)e.websocket.pendingCalls.hasOwnProperty(n)&&e.websocket.pendingCalls[n].reject(new Error("Connection closed before response received"))},e.websocket.connection.onerror=function(t){e.websocket.callError(t)},e.websocket.connection.sendData=function(t){e.log.trace("Preparing object for websocket",t),null==t.timestamp&&(t.timestamp=Date.now(),"number"!=typeof t.timestamp&&(t.timestamp=(new Date).getTime())),null!=t.promise&&(t.uid=e.websocket.setup.newUID(),e.websocket.pendingCalls[t.uid]=t.promise),t.position={x:screen?(screen.availWidth||screen.width)/2+(screen.left||screen.availLeft):0,y:screen?(screen.availHeight||screen.height)/2+(screen.top||screen.availTop):0};try{if(null!=t.call&&null==t.signature){var n=e.tools.hash(e.tools.stringify({call:t.call,params:t.params,timestamp:t.timestamp}));n.then||(n=e.tools.promise(function(e){e(n)})),n.then(function(t){return e.security.callSign(t)}).then(function(n){e.log.trace("Signature for call",n),t.signature=n,e.signContent=void 0,e.websocket.connection.send(e.tools.stringify(t))})}else e.log.trace("Signature for call",t.signature),e.websocket.connection.send(e.tools.stringify(t))}catch(r){e.log.error(r),null!=t.promise&&(t.promise.reject(r),delete e.websocket.pendingCalls[t.uid])}},e.websocket.connection.onmessage=function(t){var n=JSON.parse(t.data);if(null!=n.uid){e.log.trace("Received response from websocket",n);var r=e.websocket.pendingCalls[n.uid];null==r?e.log.warn("No promise found for returned response"):null!=n.error?r.reject(new Error(n.error)):r.resolve(n.result),delete e.websocket.pendingCalls[n.uid]}else if(null==n.type)e.websocket.connection.close(4003,"Connected to incompatible QZ Tray version");else switch(n.type){case e.streams.serial:n.event||(n.event=JSON.stringify({portName:n.key,output:n.data})),e.serial.callSerial(JSON.parse(n.event));break;case e.streams.usb:n.event||(n.event=JSON.stringify({vendorId:n.key[0],productId:n.key[1],output:n.data})),e.usb.callUsb(JSON.parse(n.event));break;case e.streams.hid:e.hid.callHid(JSON.parse(n.event));break;default:e.log.warn("Cannot determine stream type for callback",n)}},e.security.callCert().then(n).catch(n)},newUID:function(){return(new Array(7).join("0")+(Math.random()*Math.pow(36,6)<<0).toString(36)).slice(-6)}},dataPromise:function(t,n,r,o){return e.tools.promise(function(i,s){e.websocket.connection.sendData({call:t,promise:{resolve:i,reject:s},params:n,signature:r,timestamp:o})})},pendingCalls:{},errorCallbacks:[],callError:function(t){if(Array.isArray(e.websocket.errorCallbacks))for(var n=0;n<e.websocket.errorCallbacks.length;n++)e.websocket.errorCallbacks[n](t);else e.websocket.errorCallbacks(t)},closedCallbacks:[],callClose:function(t){if(Array.isArray(e.websocket.closedCallbacks))for(var n=0;n<e.websocket.closedCallbacks.length;n++)e.websocket.closedCallbacks[n](t);else e.websocket.closedCallbacks(t)}},printing:{defaultConfig:{colorType:"color",copies:1,density:0,duplex:!1,fallbackDensity:null,interpolation:"bicubic",jobName:null,legacy:!1,margins:0,orientation:null,paperThickness:null,printerTray:null,rasterize:!0,rotation:0,scaleContent:!0,size:null,units:"in",altPrinting:!1,encoding:null,endOfDoc:null,perSpool:1}},serial:{serialCallbacks:[],callSerial:function(t){if(Array.isArray(e.serial.serialCallbacks))for(var n=0;n<e.serial.serialCallbacks.length;n++)e.serial.serialCallbacks[n](t);else e.serial.serialCallbacks(t)}},usb:{usbCallbacks:[],callUsb:function(t){if(Array.isArray(e.usb.usbCallbacks))for(var n=0;n<e.usb.usbCallbacks.length;n++)e.usb.usbCallbacks[n](t);else e.usb.usbCallbacks(t)}},hid:{hidCallbacks:[],callHid:function(t){if(Array.isArray(e.hid.hidCallbacks))for(var n=0;n<e.hid.hidCallbacks.length;n++)e.hid.hidCallbacks[n](t);else e.hid.hidCallbacks(t)}},security:{certPromise:function(e,t){t()},callCert:function(){return e.tools.promise(e.security.certPromise)},signaturePromise:function(){return function(e){e()}},callSign:function(t){return e.tools.promise(e.security.signaturePromise(t))}},tools:{promise:function(e){return new RSVP.Promise(e)},stringify:function(e){var t=Array.prototype.toJSON;delete Array.prototype.toJSON;var n=JSON.stringify(e);return t&&(Array.prototype.toJSON=t),n},hash:function(e){return Sha256.hash(e)},ws:"undefined"!=typeof WebSocket?WebSocket:null,absolute:function(e){if("undefined"!=typeof window&&"function"==typeof document.createElement){var t=document.createElement("a");return t.href=e,t.href}return e},extend:function(t){"object"!=typeof t&&(t={});for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var o in r)if(r.hasOwnProperty(o)){if(t===r[o])continue;var i;r[o]&&r[o].constructor&&r[o].constructor===Object?(i=Array.isArray(r[o])?t[o]||[]:t[o]||{},t[o]=e.tools.extend(i,r[o])):void 0!==r[o]&&(t[o]=r[o])}}return t}}};function t(t,n){this.setPrinter=function(e){"string"==typeof e&&(e={name:e}),this.printer=e},this.getPrinter=function(){return this.printer},this.reconfigure=function(t){e.tools.extend(this.config,t)},this.getOptions=function(){return this.config},this.setPrinter(t),this.config=n}return t.prototype.print=function(e,t,n){qz.print(this,e,t,n)},{websocket:{isActive:function(){return null!=e.websocket.connection&&e.websocket.connection.established},connect:function(t){return e.tools.promise(function(n,r){if(qz.websocket.isActive())r(new Error("An open connection with QZ Tray already exists"));else if(null==e.websocket.connection)if(e.tools.ws)if(e.tools.ws.CLOSED&&2!=e.tools.ws.CLOSED){null==t&&(t={}),"undefined"!=typeof location&&"https:"===location.protocol||void 0===t.usingSecure&&(e.log.trace("Disabling secure ports due to insecure page"),t.usingSecure=!1),void 0===t.host||Array.isArray(t.host)||(t.host=[t.host]);var o=function(i){var s=!1,c=function(){s||(s=!0,t&&i<t.retries?o(i+1):r.apply(null,arguments))},a=function(){var r=e.tools.extend({},e.websocket.connectConfig,t);e.websocket.setup.findConnection(r,n,c)};0==i?a():setTimeout(a,1e3*t.delay)};o(0)}else r(new Error("Unsupported WebSocket version detected: HyBi-00/Hixie-76"));else r(new Error("WebSocket not supported by this browser"));else r(new Error("The current connection attempt has not returned yet"))})},disconnect:function(){return e.tools.promise(function(t,n){qz.websocket.isActive()?(e.websocket.connection.close(),e.websocket.connection.promise={resolve:t,reject:n}):n(new Error("No open connection with QZ Tray"))})},setErrorCallbacks:function(t){e.websocket.errorCallbacks=t},setClosedCallbacks:function(t){e.websocket.closedCallbacks=t},getNetworkInfo:function(t,n){return e.websocket.dataPromise("websocket.getNetworkInfo",{hostname:t,port:n})},getConnectionInfo:function(){if(e.websocket.connection){var t=e.websocket.connection.url.split(/[:\/]+/g);return{socket:t[0],host:t[1],port:+t[2]}}throw new Error("A connection to QZ has not been established yet")}},printers:{getDefault:function(){return e.websocket.dataPromise("printers.getDefault")},find:function(t){return e.websocket.dataPromise("printers.find",{query:t})}},configs:{setDefaults:function(t){e.tools.extend(e.printing.defaultConfig,t)},create:function(n,r){return new t(n,e.tools.extend({},e.printing.defaultConfig,r))}},print:function(t,n,r,o){for(var i=0;i<n.length;i++)n[i].constructor===Object&&((!n[i].format&&n[i].type&&"RAW"!==n[i].type.toUpperCase()&&"DIRECT"!==n[i].type.toUpperCase()||n[i].format&&("FILE"===n[i].format.toUpperCase()||"IMAGE"===n[i].format.toUpperCase()&&(0!==n[i].data.indexOf("data:image/")||0===n[i].data.indexOf(";base64,"))||"XML"===n[i].format.toUpperCase()))&&(n[i].data=e.tools.absolute(n[i].data)),n[i].options&&"string"==typeof n[i].options.overlay&&(n[i].options.overlay=e.tools.absolute(n[i].options.overlay)));var s={printer:t.getPrinter(),options:t.getOptions(),data:n};return e.websocket.dataPromise("print",s,r,o)},serial:{findPorts:function(){return e.websocket.dataPromise("serial.findPorts")},setSerialCallbacks:function(t){e.serial.serialCallbacks=t},openPort:function(t,n){return e.websocket.dataPromise("serial.openPort",{port:t,options:n})},sendData:function(t,n,r){return null!=r&&e.log.warn("Properties object is deprecated on sendData calls, use openPort instead."),e.websocket.dataPromise("serial.sendData",{port:t,data:n,properties:r})},closePort:function(t){return e.websocket.dataPromise("serial.closePort",{port:t})}},usb:{listDevices:function(t){return e.websocket.dataPromise("usb.listDevices",{includeHubs:t})},listInterfaces:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("usb.listInterfaces",t)},listEndpoints:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],interface:arguments[2]}),e.websocket.dataPromise("usb.listEndpoints",t)},setUsbCallbacks:function(t){e.usb.usbCallbacks=t},claimDevice:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],interface:arguments[2]}),e.websocket.dataPromise("usb.claimDevice",t)},isClaimed:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("usb.isClaimed",t)},sendData:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],endpoint:arguments[2],data:arguments[3]}),e.websocket.dataPromise("usb.sendData",t)},readData:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],endpoint:arguments[2],responseSize:arguments[3]}),e.websocket.dataPromise("usb.readData",t)},openStream:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],endpoint:arguments[2],responseSize:arguments[3],interval:arguments[4]}),e.websocket.dataPromise("usb.openStream",t)},closeStream:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],endpoint:arguments[2]}),e.websocket.dataPromise("usb.closeStream",t)},releaseDevice:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("usb.releaseDevice",t)}},hid:{listDevices:function(){return e.websocket.dataPromise("hid.listDevices")},startListening:function(){return e.websocket.dataPromise("hid.startListening")},stopListening:function(){return e.websocket.dataPromise("hid.stopListening")},setHidCallbacks:function(t){e.hid.hidCallbacks=t},claimDevice:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("hid.claimDevice",t)},isClaimed:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("hid.isClaimed",t)},sendData:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],data:arguments[2],endpoint:arguments[3]}),e.websocket.dataPromise("hid.sendData",t)},readData:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],responseSize:arguments[2]}),e.websocket.dataPromise("hid.readData",t)},openStream:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1],responseSize:arguments[2],interval:arguments[3]}),e.websocket.dataPromise("hid.openStream",t)},closeStream:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("hid.closeStream",t)},releaseDevice:function(t){return"object"!=typeof t&&(t={vendorId:arguments[0],productId:arguments[1]}),e.websocket.dataPromise("hid.releaseDevice",t)}},security:{setCertificatePromise:function(t){e.security.certPromise=t},setSignaturePromise:function(t){e.security.signaturePromise=t}},api:{showDebug:function(t){e.DEBUG=t},getVersion:function(){return e.websocket.dataPromise("getVersion")},setPromiseType:function(t){e.tools.promise=t},setSha256Type:function(t){e.tools.hash=t},setWebSocketType:function(t){e.tools.ws=t}},version:e.VERSION}}();!function(){if("function"==typeof define&&define.amd)define(qz);else if("object"==typeof exports){module.exports=qz;try{var e=require("crypto");qz.api.setSha256Type(function(t){return e.createHash("sha256").update(t).digest("hex")})}catch(t){}}else window.qz=qz}();